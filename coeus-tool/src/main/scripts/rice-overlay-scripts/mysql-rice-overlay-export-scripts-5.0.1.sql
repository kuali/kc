--
-- Kuali Coeus, a comprehensive research administration system for higher education.
-- 
-- Copyright 2005-2015 Kuali, Inc.
-- 
-- This program is free software: you can redistribute it and/or modify
-- it under the terms of the GNU Affero General Public License as
-- published by the Free Software Foundation, either version 3 of the
-- License, or (at your option) any later version.
-- 
-- This program is distributed in the hope that it will be useful,
-- but WITHOUT ANY WARRANTY; without even the implied warranty of
-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-- GNU Affero General Public License for more details.
-- 
-- You should have received a copy of the GNU Affero General Public License
-- along with this program.  If not, see <http://www.gnu.org/licenses/>.
--

use krdev;
-- EXPORT SQLS 
-- Removed a bunch of last_updated_dt columns because it was causing issues in oracle
-- changed the KC prefix to KCoeus because the KC prefix was already being added in base KC data, and there were PK clashes if KCoes was not added for example there are PKs like 5108 and PKs like KC5108 so adding KC prefix clashes with the existing numbered ones.
SELECT * INTO OUTFILE '/tmp/riceOverlay/KRCR_NMSPC_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n' FROM KRCR_NMSPC_T WHERE NMSPC_CD LIKE 'KC%';

SELECT * INTO OUTFILE '/tmp/riceOverlay/KRCR_CMPNT_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n' FROM KRCR_CMPNT_T WHERE NMSPC_CD LIKE 'KC%';

# 
SELECT * FROM KRCR_PARM_T WHERE PARM_NM = 'kuali.docHandler.url.prefix'
UNION
SELECT * INTO OUTFILE '/tmp/riceOverlay/KRCR_PARM_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n' FROM KRCR_PARM_T WHERE NMSPC_CD LIKE 'KC%';

## Added this in
SELECT AFLTN_TYP_CD, OBJ_ID, VER_NBR, NM, EMP_AFLTN_TYP_IND, ACTV_IND, DISPLAY_SORT_CD FROM KRIM_AFLTN_TYP_T WHERE AFLTN_TYP_CD NOT IN ('STDNT', 'FCLTY', 'STAFF', 'AFLT') INTO OUTFILE '/tmp/riceOverlay/KRIM_AFLTN_TYP_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

#Added this in
select PHONE_TYP_CD, OBJ_ID, VER_NBR, PHONE_TYP_NM, ACTV_IND, DISPLAY_SORT_CD from KRIM_PHONE_TYP_T WHERE PHONE_TYP_CD = 'FAX' INTO OUTFILE '/tmp/riceOverlay/KRIM_PHONE_TYP_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CONCAT('KCoeus',ENTITY_ID) AS ENTITY_ID, OBJ_ID, VER_NBR, ACTV_IND FROM KRIM_ENTITY_T WHERE ENTITY_ID > 10000 AND ENTITY_ID < 10097
UNION 
SELECT CONCAT('KCoeus',ENTITY_ID) AS ENTITY_ID, OBJ_ID, VER_NBR, ACTV_IND FROM KRIM_ENTITY_T WHERE ENTITY_ID = (SELECT ENTITY_ID FROM KRIM_PRNCPL_T WHERE UPPER(PRNCPL_NM) = 'KC') INTO OUTFILE '/tmp/riceOverlay/KRIM_ENTITY_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CONCAT('KCoeus',ENTITY_ID) AS ENTITY_ID, ENT_TYP_CD, ACTV_IND, OBJ_ID, VER_NBR FROM KRIM_ENTITY_ENT_TYP_T WHERE ENTITY_ID > 10000 AND ENTITY_ID < 10097 
UNION 
SELECT CONCAT('KCoeus',ENTITY_ID) AS ENTITY_ID, ENT_TYP_CD, ACTV_IND, OBJ_ID, VER_NBR FROM KRIM_ENTITY_ENT_TYP_T WHERE ENTITY_ID = (SELECT ENTITY_ID FROM KRIM_PRNCPL_T WHERE UPPER(PRNCPL_NM) = 'KC') INTO OUTFILE '/tmp/riceOverlay/KRIM_ENTITY_ENT_TYP_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

-- made nm_chng_dt null
SELECT CONCAT('KCoeus',ENTITY_NM_ID) AS ENTITY_NM_ID, CONCAT('KCoeus',ENTITY_ID) AS ENTITY_ID, NM_TYP_CD, FIRST_NM, MIDDLE_NM, LAST_NM, SUFFIX_NM, TITLE_NM, DFLT_IND, ACTV_IND, OBJ_ID, VER_NBR, PREFIX_NM, NOTE_MSG,
CASE WHEN NM_CHNG_DT IS NOT NULL THEN NULL ELSE NM_CHNG_DT END AS NM_CHNG_DT
FROM KRIM_ENTITY_NM_T WHERE ENTITY_ID > 10000 AND ENTITY_ID < 10097
UNION 
SELECT CONCAT('KCoeus',ENTITY_NM_ID) AS ENTITY_NM_ID, CONCAT('KCoeus',ENTITY_ID) AS ENTITY_ID, NM_TYP_CD, FIRST_NM, MIDDLE_NM, LAST_NM, SUFFIX_NM, TITLE_NM, DFLT_IND, ACTV_IND, OBJ_ID, VER_NBR, PREFIX_NM, NOTE_MSG, 
CASE WHEN NM_CHNG_DT IS NOT NULL THEN NULL ELSE NM_CHNG_DT END AS NM_CHNG_DT
 FROM KRIM_ENTITY_NM_T WHERE ENTITY_ID = (SELECT ENTITY_ID FROM KRIM_PRNCPL_T WHERE UPPER(PRNCPL_NM) = 'KC') INTO OUTFILE '/tmp/riceOverlay/KRIM_ENTITY_NM_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

-- VALID_DT NULL
SELECT CONCAT('KCoeus',ENTITY_ADDR_ID) AS ENTITY_ADDR_ID, CONCAT('KCoeus',ENTITY_ID) AS ENTITY_ID, ENT_TYP_CD, ADDR_TYP_CD, ADDR_LINE_1, ADDR_LINE_2, ADDR_LINE_3, CITY, STATE_PVC_CD, POSTAL_CD, POSTAL_CNTRY_CD, DFLT_IND, ACTV_IND, OBJ_ID, VER_NBR, ATTN_LINE, ADDR_FMT, 
CASE WHEN VALID_DT IS NOT NULL THEN NULL ELSE VALID_DT END AS VALID_DT
, VALID_IND, NOTE_MSG  FROM KRIM_ENTITY_ADDR_T WHERE ENTITY_ID > 10000 AND ENTITY_ID < 10097
UNION 
SELECT CONCAT('KCoeus',ENTITY_ADDR_ID) AS ENTITY_ADDR_ID, CONCAT('KCoeus',ENTITY_ID) AS ENTITY_ID, ENT_TYP_CD, ADDR_TYP_CD, ADDR_LINE_1, ADDR_LINE_2, ADDR_LINE_3, CITY, STATE_PVC_CD, POSTAL_CD, POSTAL_CNTRY_CD, DFLT_IND, ACTV_IND, OBJ_ID, VER_NBR, ATTN_LINE, ADDR_FMT, 
CASE WHEN VALID_DT IS NOT NULL THEN NULL ELSE VALID_DT END AS VALID_DT
, VALID_IND, NOTE_MSG  FROM KRIM_ENTITY_ADDR_T WHERE ENTITY_ID = (SELECT ENTITY_ID FROM KRIM_PRNCPL_T WHERE UPPER(PRNCPL_NM) = 'KC') INTO OUTFILE '/tmp/riceOverlay/KRIM_ENTITY_ADDR_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CONCAT('KCoeus',ENTITY_AFLTN_ID) AS ENTITY_AFLTN_ID, CONCAT('KCoeus',ENTITY_ID) AS ENTITY_ID, AFLTN_TYP_CD, CAMPUS_CD, DFLT_IND, ACTV_IND, OBJ_ID, VER_NBR FROM KRIM_ENTITY_AFLTN_T WHERE ENTITY_ID > 10000 AND ENTITY_ID < 10097
UNION
SELECT CONCAT('KCoeus',ENTITY_AFLTN_ID) AS ENTITY_AFLTN_ID, CONCAT('KCoeus',ENTITY_ID) AS ENTITY_ID, AFLTN_TYP_CD, CAMPUS_CD, DFLT_IND, ACTV_IND, OBJ_ID, VER_NBR FROM KRIM_ENTITY_AFLTN_T WHERE ENTITY_ID = (SELECT ENTITY_ID FROM KRIM_PRNCPL_T WHERE UPPER(PRNCPL_NM) = 'KC') INTO OUTFILE '/tmp/riceOverlay/KRIM_ENTITY_AFLTN_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

## ??? why 2 entity_afltn_id
SELECT CONCAT('KCoeus',ENTITY_EMP_ID) AS ENTITY_EMP_ID, CONCAT('KCoeus',ENTITY_ID) AS ENTITY_ID, 
       CASE ENTITY_AFLTN_ID 
       	    WHEN NULL THEN 'NULL' 
	    WHEN '' THEN 'NULL' 
	    ELSE CONCAT('KCoeus', ENTITY_AFLTN_ID) 
	    END ENTITY_AFLTN_ID,  
       CASE EMP_STAT_CD 
       	    WHEN NULL THEN 'NULL' 
	    WHEN '' THEN 'NULL' 
	    END AS EMP_STAT_CD, 
       CASE EMP_TYP_CD
       	    WHEN NULL THEN 'NULL' 
	    WHEN '' THEN 'NULL' 
	    END AS EMP_TYP_CD, PRMRY_IND, ACTV_IND, PRMRY_DEPT_CD, EMP_ID, EMP_REC_ID, OBJ_ID, VER_NBR, BASE_SLRY_AMT FROM KRIM_ENTITY_EMP_INFO_T WHERE ENTITY_ID > 10000 AND ENTITY_ID <10097
UNION 
SELECT CONCAT('KCoeus',ENTITY_EMP_ID) AS ENTITY_EMP_ID, CONCAT('KCoeus',ENTITY_ID) AS ENTITY_ID, CASE ENTITY_AFLTN_ID WHEN  NULL THEN 'NULL' WHEN '' THEN 'NULL' ELSE CONCAT('KCoeus',ENTITY_AFLTN_ID) END ENTITY_AFLTN_ID, CASE EMP_STAT_CD WHEN NULL THEN 'NULL' WHEN '' THEN 'NULL' END AS EMP_STAT_CD, CASE EMP_TYP_CD WHEN NULL THEN'NULL' WHEN '' THEN 'NULL' END AS EMP_TYP_CD, PRMRY_IND, ACTV_IND, PRMRY_DEPT_CD, EMP_ID, EMP_REC_ID, OBJ_ID, VER_NBR, BASE_SLRY_AMT FROM KRIM_ENTITY_EMP_INFO_T WHERE ENTITY_ID = (SELECT ENTITY_ID FROM KRIM_PRNCPL_T WHERE UPPER(PRNCPL_NM) = 'KC') INTO OUTFILE '/tmp/riceOverlay/KRIM_ENTITY_EMP_INFO_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CONCAT('KCoeus',ENTITY_EMAIL_ID) AS ENTITY_EMAIL_ID, CONCAT('KCoeus',ENTITY_ID) AS ENTITY_ID, ENT_TYP_CD, EMAIL_TYP_CD, EMAIL_ADDR, DFLT_IND, ACTV_IND, OBJ_ID, VER_NBR FROM KRIM_ENTITY_EMAIL_T WHERE ENTITY_ID > 10000 AND ENTITY_ID < 10097
UNION 
SELECT CONCAT('KCoeus',ENTITY_EMAIL_ID) AS ENTITY_EMAIL_ID, CONCAT('KCoeus',ENTITY_ID) AS ENTITY_ID, ENT_TYP_CD, EMAIL_TYP_CD, EMAIL_ADDR, DFLT_IND, ACTV_IND, OBJ_ID, VER_NBR FROM KRIM_ENTITY_EMAIL_T WHERE ENTITY_ID = (SELECT ENTITY_ID FROM KRIM_PRNCPL_T WHERE UPPER(PRNCPL_NM) = 'KC') INTO OUTFILE '/tmp/riceOverlay/KRIM_ENTITY_EMAIL_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CONCAT('KCoeus',ENTITY_PHONE_ID) AS ENTITY_PHONE_ID, CONCAT('KCoeus',ENTITY_ID) AS ENTITY_ID, ENT_TYP_CD, PHONE_TYP_CD, PHONE_NBR, PHONE_EXTN_NBR, POSTAL_CNTRY_CD, DFLT_IND, ACTV_IND, OBJ_ID, VER_NBR FROM KRIM_ENTITY_PHONE_T WHERE ENTITY_ID > 10000 AND ENTITY_ID < 10097
UNION 
SELECT CONCAT('KCoeus',ENTITY_PHONE_ID) AS ENTITY_PHONE_ID, CONCAT('KCoeus',ENTITY_ID) AS ENTITY_ID, ENT_TYP_CD, PHONE_TYP_CD, PHONE_NBR, PHONE_EXTN_NBR, POSTAL_CNTRY_CD, DFLT_IND, ACTV_IND, OBJ_ID, VER_NBR FROM KRIM_ENTITY_PHONE_T WHERE ENTITY_ID = (SELECT ENTITY_ID FROM KRIM_PRNCPL_T WHERE UPPER(PRNCPL_NM) = 'KC') INTO OUTFILE '/tmp/riceOverlay/KRIM_ENTITY_PHONE_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT PRNCPL_ID AS PRNCPL_ID, CONCAT('kc',PRNCPL_NM) AS PRNCPL_NM, CONCAT('KCoeus',ENTITY_ID) AS ENTITY_ID, PRNCPL_PSWD, ACTV_IND, OBJ_ID, VER_NBR FROM KRIM_PRNCPL_T WHERE ENTITY_ID > 10000 AND ENTITY_ID < 10097
UNION 
SELECT CONCAT('KCoeus',PRNCPL_ID) AS PRNCPL_ID, PRNCPL_NM AS PRNCPL_NM, CONCAT('KCoeus',ENTITY_ID) AS ENTITY_ID, PRNCPL_PSWD, ACTV_IND, OBJ_ID, VER_NBR FROM KRIM_PRNCPL_T WHERE UPPER(PRNCPL_NM) = 'KC' INTO OUTFILE '/tmp/riceOverlay/KRIM_PRNCPL_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CONCAT('KCoeus',KIM_ATTR_DEFN_ID) AS KIM_ATTR_DEFN_ID, NM, LBL, ACTV_IND, NMSPC_CD, CMPNT_NM, OBJ_ID, VER_NBR FROM KRIM_ATTR_DEFN_T WHERE NMSPC_CD LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRIM_ATTR_DEFN_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CONCAT('KCoeus',KIM_TYP_ID) AS KIM_TYP_ID, NM, SRVC_NM, ACTV_IND, NMSPC_CD, OBJ_ID, VER_NBR FROM KRIM_TYP_T WHERE NMSPC_CD LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRIM_TYP_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CONCAT('KCoeus',KIM_TYP_ATTR_ID) AS KIM_TYP_ATTR_ID, CONCAT('KCoeus',KIM_TYP_ID) AS KIM_TYP_ID, 
   CASE WHEN KIM_ATTR_DEFN_ID IN (SELECT KIM_ATTR_DEFN_ID FROM KRIM_ATTR_DEFN_T WHERE NMSPC_CD LIKE 'KC%') 
   THEN CONCAT('KCoeus',KIM_ATTR_DEFN_ID) 
   ELSE KIM_ATTR_DEFN_ID END AS KIM_ATTR_DEFN_ID,  
SORT_CD, ACTV_IND, OBJ_ID, VER_NBR FROM KRIM_TYP_ATTR_T WHERE KIM_TYP_ID IN (SELECT KIM_TYP_ID FROM KRIM_TYP_T WHERE NMSPC_CD LIKE 'KC%') INTO OUTFILE '/tmp/riceOverlay/KRIM_TYP_ATTR_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CONCAT('KCoeus',PERM_TMPL_ID) AS PERM_TMPL_ID, NMSPC_CD, NM, DESC_TXT, 
   CASE WHEN KIM_TYP_ID IN (SELECT KIM_TYP_ID FROM KRIM_TYP_T WHERE NMSPC_CD LIKE 'KC%') 
   THEN CONCAT('KCoeus',KIM_TYP_ID) 
   ELSE KIM_TYP_ID END AS KIM_TYP_ID,  
ACTV_IND, OBJ_ID, VER_NBR FROM KRIM_PERM_TMPL_T WHERE NMSPC_CD LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRIM_PERM_TMPL_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CONCAT('KCoeus',PERM_ID) AS PERM_ID, NMSPC_CD, NM, DESC_TXT, 
   CASE WHEN PERM_TMPL_ID IN (SELECT PERM_TMPL_ID FROM KRIM_PERM_TMPL_T WHERE NMSPC_CD LIKE 'KC%') 
   THEN CONCAT('KCoeus',PERM_TMPL_ID) 
   ELSE PERM_TMPL_ID END AS PERM_TMPL_ID, 
ACTV_IND, OBJ_ID, VER_NBR FROM KRIM_PERM_T  WHERE NMSPC_CD LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRIM_PERM_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CONCAT('KCoeus',ATTR_DATA_ID) AS ATTR_DATA_ID, CONCAT('KCoeus',PERM_ID) AS PERM_ID, 
   CASE WHEN KIM_TYP_ID IN (SELECT KIM_TYP_ID FROM KRIM_TYP_T WHERE NMSPC_CD LIKE 'KC%') 
   THEN CONCAT('KCoeus',KIM_TYP_ID) 
   ELSE KIM_TYP_ID END AS KIM_TYP_ID,  
   CASE WHEN KIM_ATTR_DEFN_ID IN (SELECT KIM_ATTR_DEFN_ID FROM KRIM_ATTR_DEFN_T WHERE NMSPC_CD LIKE 'KC%') 
   THEN CONCAT('KCoeus',KIM_ATTR_DEFN_ID) 
   ELSE KIM_ATTR_DEFN_ID END AS KIM_ATTR_DEFN_ID,  
ATTR_VAL, OBJ_ID, VER_NBR FROM KRIM_PERM_ATTR_DATA_T WHERE PERM_ID IN (SELECT PERM_ID FROM KRIM_PERM_T WHERE NMSPC_CD LIKE 'KC%') INTO OUTFILE '/tmp/riceOverlay/KRIM_PERM_ATTR_DATA_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CONCAT('KCoeus',ROLE_ID) AS ROLE_ID, ROLE_NM, NMSPC_CD, DESC_TXT, 
   CASE WHEN KIM_TYP_ID IN (SELECT KIM_TYP_ID FROM KRIM_TYP_T WHERE NMSPC_CD LIKE 'KC%') 
   THEN CONCAT('KCoeus',KIM_TYP_ID)
   ELSE KIM_TYP_ID END AS KIM_TYP_ID,  
ACTV_IND, OBJ_ID, VER_NBR FROM KRIM_ROLE_T WHERE NMSPC_CD LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRIM_ROLE_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

-- MADE DATES NOT NULL
SELECT CONCAT('KCoeus',ROLE_MBR_ID) AS ROLE_MBR_ID, 
   CASE WHEN ROLE_ID IN (SELECT ROLE_ID FROM KRIM_ROLE_T WHERE NMSPC_CD LIKE 'KC%') 
   THEN CONCAT('KCoeus',ROLE_ID) 
   ELSE ROLE_ID END AS ROLE_ID,  
   CASE 
   WHEN MBR_ID IN (SELECT PRNCPL_ID FROM KRIM_PRNCPL_T WHERE PRNCPL_NM IN ('kc'))  
   THEN CONCAT('KCoeus',MBR_ID)  
   WHEN MBR_ID IN (SELECT GRP_ID FROM KRIM_GRP_T WHERE NMSPC_CD LIKE 'KC%')  
   THEN CONCAT('100',MBR_ID) 
   WHEN MBR_ID IN (SELECT ROLE_ID FROM KRIM_ROLE_T WHERE NMSPC_CD LIKE 'KC%')  
   THEN CONCAT('KCoeus',MBR_ID) 
   ELSE MBR_ID END AS MBR_ID,     
MBR_TYP_CD, OBJ_ID, VER_NBR,
CASE WHEN ACTV_FRM_DT IS NOT NULL THEN NULL ELSE ACTV_FRM_DT END AS ACTV_FRM_DT, 
CASE WHEN ACTV_TO_DT IS NOT NULL THEN NULL ELSE ACTV_TO_DT END AS ACTV_TO_DT
FROM KRIM_ROLE_MBR_T  WHERE ROLE_ID IN (SELECT ROLE_ID FROM KRIM_ROLE_T WHERE NMSPC_CD LIKE 'KC%') INTO OUTFILE '/tmp/riceOverlay/KRIM_ROLE_MBR_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CONCAT('KCoeus',ATTR_DATA_ID) AS ATTR_DATA_ID, CONCAT('KCoeus',ROLE_MBR_ID) AS ROLE_MBR_ID, 
   CASE WHEN KIM_TYP_ID IN (SELECT KIM_TYP_ID FROM KRIM_TYP_T WHERE NMSPC_CD LIKE 'KC%') 
   THEN CONCAT('KCoeus',KIM_TYP_ID) 
   ELSE KIM_TYP_ID END AS KIM_TYP_ID,  
   CASE WHEN KIM_ATTR_DEFN_ID IN (SELECT KIM_ATTR_DEFN_ID FROM KRIM_ATTR_DEFN_T WHERE NMSPC_CD LIKE 'KC%') 
   THEN CONCAT('KCoeus',KIM_ATTR_DEFN_ID) 
   ELSE KIM_ATTR_DEFN_ID END AS KIM_ATTR_DEFN_ID, ATTR_VAL, OBJ_ID, VER_NBR FROM KRIM_ROLE_MBR_ATTR_DATA_T WHERE ROLE_MBR_ID IN (SELECT DISTINCT ROLE_MBR_ID FROM KRIM_ROLE_MBR_T WHERE ROLE_ID IN (SELECT ROLE_ID FROM KRIM_ROLE_T WHERE NMSPC_CD LIKE 'KC%')) INTO OUTFILE '/tmp/riceOverlay/KRIM_ROLE_MBR_ATTR_DATA_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CONCAT('KCoeus',ROLE_PERM_ID) AS ROLE_PERM_ID, 
   CASE WHEN ROLE_ID IN (SELECT ROLE_ID FROM KRIM_ROLE_T WHERE NMSPC_CD LIKE 'KC%') 
   THEN CONCAT('KCoeus',ROLE_ID) 
   ELSE ROLE_ID END AS ROLE_ID,  
   CASE WHEN PERM_ID IN (SELECT PERM_ID FROM KRIM_PERM_T WHERE NMSPC_CD LIKE 'KC%') 
   THEN CONCAT('KCoeus',PERM_ID) 
   ELSE PERM_ID END AS PERM_ID,  
ACTV_IND, OBJ_ID, VER_NBR FROM KRIM_ROLE_PERM_T WHERE ROLE_ID IN (SELECT ROLE_ID FROM KRIM_ROLE_T WHERE NMSPC_CD LIKE 'KC%') INTO OUTFILE '/tmp/riceOverlay/KRIM_ROLE_PERM_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CONCAT('100',GRP_ID) AS GRP_ID, GRP_NM, NMSPC_CD, GRP_DESC, 
   CASE WHEN KIM_TYP_ID IN (SELECT KIM_TYP_ID FROM KRIM_TYP_T WHERE NMSPC_CD LIKE 'KC%') 
   THEN CONCAT('KCoeus',KIM_TYP_ID) 
   ELSE KIM_TYP_ID END AS KIM_TYP_ID,  
ACTV_IND, OBJ_ID, VER_NBR FROM KRIM_GRP_T WHERE NMSPC_CD LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRIM_GRP_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

-- MADE DATES NULL
SELECT CONCAT('KCoeus',GRP_MBR_ID) AS GRP_MBR_ID, CONCAT('100',GRP_ID) AS GRP_ID, 
   CASE 
   WHEN MBR_ID IN (SELECT PRNCPL_ID FROM KRIM_PRNCPL_T WHERE PRNCPL_NM IN ('kc'))  
   THEN CONCAT('KCoeus',MBR_ID)  
   WHEN MBR_ID IN (SELECT GRP_ID FROM KRIM_GRP_T WHERE NMSPC_CD LIKE 'KC%')  
   THEN CONCAT('100',MBR_ID)
   WHEN MBR_ID IN (SELECT ROLE_ID FROM KRIM_ROLE_T WHERE NMSPC_CD LIKE 'KC%')  
   THEN CONCAT('KCoeus',MBR_ID) 
   ELSE MBR_ID END AS MBR_ID, 
MBR_TYP_CD, OBJ_ID, VER_NBR, 
CASE WHEN ACTV_FRM_DT IS NOT NULL THEN NULL ELSE ACTV_FRM_DT END AS ACTV_FRM_DT, 
CASE WHEN ACTV_TO_DT IS NOT NULL THEN NULL ELSE ACTV_TO_DT END AS ACTV_TO_DT 
FROM KRIM_GRP_MBR_T WHERE GRP_ID IN (SELECT GRP_ID FROM KRIM_GRP_T WHERE NMSPC_CD LIKE 'KC%') INTO OUTFILE '/tmp/riceOverlay/KRIM_GRP_MBR_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CONCAT('100',RSP_ID) AS RSP_ID, NMSPC_CD, NM, DESC_TXT, ACTV_IND, RSP_TMPL_ID, OBJ_ID, VER_NBR FROM KRIM_RSP_T WHERE NMSPC_CD LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRIM_RSP_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CONCAT('KCoeus',ROLE_RSP_ID) AS ROLE_RSP_ID, CONCAT('KCoeus',ROLE_ID) AS ROLE_ID, CONCAT('100',RSP_ID) AS RSP_ID, ACTV_IND, OBJ_ID, VER_NBR FROM KRIM_ROLE_RSP_T WHERE (ROLE_ID IN (SELECT ROLE_ID FROM KRIM_ROLE_T WHERE NMSPC_CD LIKE 'KC%')) OR (RSP_ID IN (SELECT RSP_ID FROM KRIM_RSP_T WHERE NMSPC_CD LIKE 'KC%')) INTO OUTFILE '/tmp/riceOverlay/KRIM_ROLE_RSP_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CONCAT('KCoeus',ATTR_DATA_ID) AS ATTR_DATA_ID, CONCAT('100',RSP_ID) AS RSP_ID, 
   CASE WHEN KIM_TYP_ID IN (SELECT KIM_TYP_ID FROM KRIM_TYP_T WHERE NMSPC_CD LIKE 'KC%') 
   THEN CONCAT('KCoeus',KIM_TYP_ID) 
   ELSE KIM_TYP_ID END AS KIM_TYP_ID,  
   CASE WHEN KIM_ATTR_DEFN_ID IN (SELECT KIM_ATTR_DEFN_ID FROM KRIM_ATTR_DEFN_T WHERE NMSPC_CD LIKE 'KC%') 
   THEN CONCAT('KCoeus',KIM_ATTR_DEFN_ID) 
   ELSE KIM_ATTR_DEFN_ID END AS KIM_ATTR_DEFN_ID, ATTR_VAL, OBJ_ID, VER_NBR FROM KRIM_RSP_ATTR_DATA_T WHERE RSP_ID IN (SELECT RSP_ID FROM KRIM_RSP_T WHERE NMSPC_CD LIKE 'KC%') INTO OUTFILE '/tmp/riceOverlay/KRIM_RSP_ATTR_DATA_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CONCAT('KCoeus',ROLE_RSP_ACTN_ID) AS ROLE_RSP_ACTN_ID, CONCAT('KCoeus',ROLE_RSP_ID) AS ROLE_RSP_ID, CASE ROLE_MBR_ID WHEN '*' THEN ROLE_MBR_ID ELSE CONCAT('KCoeus',ROLE_MBR_ID) END AS ROLE_MBR_ID, ACTN_TYP_CD, PRIORITY_NBR, ACTN_PLCY_CD, FRC_ACTN, OBJ_ID, VER_NBR FROM KRIM_ROLE_RSP_ACTN_T WHERE ROLE_RSP_ID IN (SELECT ROLE_RSP_ID FROM KRIM_ROLE_RSP_T WHERE RSP_ID IN (SELECT RSP_ID FROM KRIM_RSP_T WHERE NMSPC_CD LIKE 'KC%')) INTO OUTFILE '/tmp/riceOverlay/KRIM_ROLE_RSP_ACTN_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT CHNL_ID, NM, DESC_TXT, SUBSCRB_IND, VER_NBR, OBJ_ID FROM KREN_CHNL_T WHERE NM LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KREN_CHNL_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT PRODCR_ID, NM, DESC_TXT, CNTCT_INFO, VER_NBR, OBJ_ID FROM KREN_PRODCR_T WHERE NM LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KREN_PRODCR_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n'; # Notification System

SELECT CHNL_ID, PRODCR_ID FROM KREN_CHNL_PRODCR_T WHERE CHNL_ID IN (SELECT CHNL_ID FROM KREN_CHNL_T WHERE NM LIKE 'KC%') INTO OUTFILE '/tmp/riceOverlay/KREN_CHNL_PRODCR_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT * FROM KRMS_ACTN_ATTR_T WHERE ACTN_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_ACTN_ATTR_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT * FROM KRMS_ACTN_T WHERE ACTN_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_ACTN_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT * FROM KRMS_AGENDA_ITM_T WHERE AGENDA_ITM_ID LIKE 'KC%' ORDER BY AGENDA_ITM_ID DESC INTO OUTFILE '/tmp/riceOverlay/KRMS_AGENDA_ITM_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT * FROM KRMS_AGENDA_T WHERE CNTXT_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_AGENDA_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n'; 

SELECT * FROM KRMS_ATTR_DEFN_T WHERE NMSPC_CD LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_ATTR_DEFN_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';  

SELECT * FROM KRMS_CMPND_PROP_PROPS_T WHERE PROP_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_CMPND_PROP_PROPS_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';  

SELECT * from KRMS_CNTXT_ATTR_T WHERE CNTXT_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_CNTXT_ATTR_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';  

SELECT * from KRMS_CNTXT_T WHERE NMSPC_CD LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_CNTXT_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';   

SELECT * from KRMS_CNTXT_VLD_ACTN_TYP_T WHERE CNTXT_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_CNTXT_VLD_ACTN_TYP_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';  

SELECT * from KRMS_CNTXT_VLD_AGENDA_TYP_T WHERE CNTXT_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_CNTXT_VLD_AGENDA_TYP_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT * from KRMS_CNTXT_VLD_FUNC_T WHERE CNTXT_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_CNTXT_VLD_FUNC_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT * from KRMS_CNTXT_VLD_RULE_TYP_T WHERE CNTXT_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_CNTXT_VLD_RULE_TYP_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT * from KRMS_CNTXT_VLD_TERM_SPEC_T WHERE CNTXT_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_CNTXT_VLD_TERM_SPEC_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT * from KRMS_CTGRY_T WHERE NMSPC_CD LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_CTGRY_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';

SELECT * from KRMS_FUNC_CTGRY_T WHERE FUNC_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_FUNC_CTGRY_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n'; 

SELECT * from KRMS_FUNC_PARM_T WHERE FUNC_PARM_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_FUNC_PARM_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n'; 

SELECT * from KRMS_FUNC_T WHERE NMSPC_CD LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_FUNC_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';  

SELECT * from KRMS_PROP_PARM_T WHERE PROP_PARM_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_PROP_PARM_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';  

SELECT * from KRMS_PROP_T WHERE PROP_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_PROP_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';  

SELECT * from KRMS_RULE_ATTR_T WHERE RULE_ATTR_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_RULE_ATTR_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';  

SELECT * from KRMS_RULE_T WHERE RULE_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_RULE_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';  

SELECT * from KRMS_TERM_PARM_T WHERE TERM_PARM_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_TERM_PARM_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';   

SELECT * from KRMS_TERM_RSLVR_ATTR_T WHERE TERM_RSLVR_ATTR_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_TERM_RSLVR_ATTR_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';    

SELECT * from KRMS_TERM_RSLVR_INPUT_SPEC_T WHERE TERM_SPEC_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_TERM_RSLVR_INPUT_SPEC_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';     

SELECT * from KRMS_TERM_RSLVR_PARM_SPEC_T WHERE TERM_RSLVR_PARM_SPEC_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_TERM_RSLVR_PARM_SPEC_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';     

SELECT * from KRMS_TERM_RSLVR_T WHERE NMSPC_CD LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_TERM_RSLVR_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';     

SELECT * from KRMS_TERM_SPEC_CTGRY_T WHERE TERM_SPEC_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_TERM_SPEC_CTGRY_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';      

SELECT * from KRMS_TERM_SPEC_T WHERE TERM_SPEC_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_TERM_SPEC_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';       

SELECT * from KRMS_TERM_T WHERE TERM_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_TERM_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';       

SELECT * from KRMS_TYP_ATTR_T WHERE TYP_ATTR_ID LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_TYP_ATTR_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';        

SELECT * from KRMS_TYP_T WHERE NMSPC_CD LIKE 'KC%' INTO OUTFILE '/tmp/riceOverlay/KRMS_TYP_T.csv' FIELDS TERMINATED BY ',' OPTIONALLY ENCLOSED BY '"' ESCAPED BY '\\' LINES TERMINATED BY '\n';        

# CLEANUP SQLS
/*
DELETE FROM KRCR_PARM_T WHERE NMSPC_CD LIKE 'KC%';
DELETE FROM KRNS_PARM_DTL_TYP_T WHERE NMSPC_CD LIKE 'KC%';
DELETE FROM KRCR_NMSPC_T WHERE NMSPC_CD LIKE 'KC%';
DELETE FROM KRIM_ENTITY_EMAIL_T WHERE ENTITY_ID > 10000 AND ENTITY_ID < 10083;
DELETE FROM KRIM_ENTITY_EMP_INFO_T WHERE ENTITY_ID > 10000 AND ENTITY_ID < 10083;
DELETE FROM KRIM_ENTITY_PHONE_T WHERE ENTITY_ID > 10000 AND ENTITY_ID < 10083;
DELETE FROM KRIM_ENTITY_ADDR_T WHERE ENTITY_ID > 10000 AND ENTITY_ID < 10083;
DELETE FROM KRIM_ENTITY_NM_T WHERE ENTITY_ID > 10000 AND ENTITY_ID < 10083;
DELETE FROM KRIM_ENTITY_ENT_TYP_T WHERE ENTITY_ID > 10000 AND ENTITY_ID < 10083;
DELETE FROM KRIM_PRNCPL_T WHERE ENTITY_ID > 10000 AND ENTITY_ID < 10083;
DELETE FROM KRIM_ENTITY_T WHERE ENTITY_ID > 10000 AND ENTITY_ID < 10083;
DELETE FROM KRIM_PHONE_TYP_T WHERE PHONE_TYP_CD = 'FAX';
DELETE FROM KRIM_GRP_MBR_T WHERE GRP_ID IN (SELECT GRP_ID FROM KRIM_GRP_T WHERE NMSPC_CD LIKE 'KC%');
DELETE FROM KRIM_GRP_T WHERE NMSPC_CD LIKE 'KC%';
DELETE FROM KRIM_ROLE_PERM_T WHERE ROLE_ID IN (SELECT ROLE_ID FROM KRIM_ROLE_T WHERE NMSPC_CD LIKE 'KC%');
DELETE FROM KRIM_ROLE_MBR_ATTR_DATA_T WHERE ROLE_MBR_ID IN (SELECT DISTINCT ROLE_MBR_ID FROM KRIM_ROLE_MBR_T WHERE ROLE_ID IN (SELECT ROLE_ID FROM KRIM_ROLE_T WHERE NMSPC_CD LIKE 'KC%'));
DELETE FROM KRIM_ROLE_MBR_T  WHERE ROLE_ID IN (SELECT ROLE_ID FROM KRIM_ROLE_T WHERE NMSPC_CD LIKE 'KC%');
DELETE FROM KRIM_ROLE_T WHERE NMSPC_CD LIKE 'KC%';
DELETE FROM KRIM_ROLE_RSP_ACTN_T WHERE ROLE_RSP_ID IN (SELECT ROLE_RSP_ID FROM KRIM_ROLE_RSP_T WHERE RSP_ID IN (SELECT RSP_ID FROM KRIM_RSP_T WHERE NMSPC_CD LIKE 'KC%'));
DELETE FROM KRIM_ROLE_RSP_T WHERE (ROLE_ID IN (SELECT ROLE_ID FROM KRIM_ROLE_T WHERE NMSPC_CD LIKE 'KC%')) OR (RSP_ID IN (SELECT RSP_ID FROM KRIM_RSP_T WHERE NMSPC_CD LIKE 'KC%'));
DELETE FROM KRIM_RSP_ATTR_DATA_T WHERE RSP_ID IN (SELECT RSP_ID FROM KRIM_RSP_T WHERE NMSPC_CD LIKE 'KC%');
DELETE FROM KRIM_RSP_T WHERE NMSPC_CD LIKE 'KC%';
DELETE FROM KRIM_PERM_ATTR_DATA_T WHERE PERM_ID IN (SELECT PERM_ID FROM KRIM_PERM_T WHERE NMSPC_CD LIKE 'KC%');
DELETE FROM KRIM_PERM_T  WHERE NMSPC_CD LIKE 'KC%';
DELETE FROM KRIM_PERM_TMPL_T WHERE NMSPC_CD LIKE 'KC%';
DELETE FROM KRIM_TYP_ATTR_T WHERE KIM_TYP_ID IN (SELECT KIM_TYP_ID FROM KRIM_TYP_T WHERE NMSPC_CD LIKE 'KC%');
DELETE FROM KRIM_TYP_T WHERE NMSPC_CD LIKE 'KC%';
DELETE FROM KRIM_ATTR_DEFN_T WHERE NMSPC_CD LIKE 'KC%';
DELETE FROM KREN_CHNL_PRODCR_T WHERE CHNL_ID IN (SELECT CHNL_ID FROM KREN_CHNL_T WHERE NM LIKE 'KC%');
DELETE FROM KREN_CHNL_T WHERE NM LIKE 'KC%';
COMMIT;
*/
