--
-- Kuali Coeus, a comprehensive research administration system for higher education.
-- 
-- Copyright 2005-2015 Kuali, Inc.
-- 
-- This program is free software: you can redistribute it and/or modify
-- it under the terms of the GNU Affero General Public License as
-- published by the Free Software Foundation, either version 3 of the
-- License, or (at your option) any later version.
-- 
-- This program is distributed in the hope that it will be useful,
-- but WITHOUT ANY WARRANTY; without even the implied warranty of
-- MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
-- GNU Affero General Public License for more details.
-- 
-- You should have received a copy of the GNU Affero General Public License
-- along with this program.  If not, see <http://www.gnu.org/licenses/>.
--

-- KC BOOTSTRAP DATA CORRECTIONS NEEDED AS OF NOW
-- take in quickstart from rice bootstrap and remove kc entries for those entities

DECLARE 
		@l_quickstart_entity_id VARCHAR(40);
		@l_quickstart_prncpl_id VARCHAR(40);
BEGIN
	
		SELECT ENTITY_ID INTO @l_quickstart_entity_id FROM KRIM_PRNCPL_T WHERE PRNCPL_NM = 'quickstart'; -- this returns 10000
		SELECT PRNCPL_ID INTO @l_quickstart_prncpl_id FROM KRIM_PRNCPL_T WHERE PRNCPL_NM = 'quickstart';

		-- quickstart user record -- max entity_id is 1132. nothing for 1109 though. why was 1109 selected?
		INSERT INTO KRIM_ENTITY_T (ACTV_IND,ENTITY_ID,LAST_UPDT_DT,OBJ_ID,VER_NBR)  
		VALUES ('Y','1109',TO_DATE( '20081113140637', '%Y%m%d' ),'5B97C50B039D6110E0404F8189D85213',1);
		INSERT INTO KRIM_ENTITY_ENT_TYP_T (ACTV_IND,ENTITY_ID,ENT_TYP_CD,LAST_UPDT_DT,OBJ_ID,VER_NBR) 
		VALUES ('Y','1109','PERSON',TO_DATE( '20081113140650', '%Y%m%d' ),'5B97C50B03E96110E0404F8189D85213',1);

		UPDATE KRIM_ENTITY_EMAIL_T SET ENTITY_ID = 1109 WHERE ENTITY_ID = @l_quickstart_entity_id;
		UPDATE KRIM_ENTITY_EMP_INFO_T SET ENTITY_ID = 1109 WHERE ENTITY_ID = @l_quickstart_entity_id;
    	UPDATE KRIM_ENTITY_AFLTN_T SET ENTITY_ID = 1109 WHERE ENTITY_ID = @l_quickstart_entity_id;
		UPDATE KRIM_ENTITY_PHONE_T SET ENTITY_ID = 1109 WHERE ENTITY_ID = @l_quickstart_entity_id;
		UPDATE KRIM_ENTITY_ADDR_T SET ENTITY_ID = 1109 WHERE ENTITY_ID = @l_quickstart_entity_id;
		UPDATE KRIM_ENTITY_NM_T SET ENTITY_ID = 1109 WHERE ENTITY_ID = @l_quickstart_entity_id;
		DELETE FROM KRIM_ENTITY_ENT_TYP_T WHERE ENTITY_ID IN ( @l_quickstart_entity_id );
		DELETE FROM KRIM_PRNCPL_T WHERE ENTITY_ID IN ( @l_quickstart_entity_id );
		
		INSERT INTO KRIM_PRNCPL_T (ACTV_IND,ENTITY_ID,LAST_UPDT_DT,OBJ_ID,PRNCPL_ID,PRNCPL_NM,VER_NBR) 
		VALUES ('Y','1109',TO_DATE( '20081113140646', '%Y%m%d' ),'5B97C50B03D86110E0404F8189D85213','quickstart','quickstart',1);

		UPDATE KRIM_GRP_MBR_T SET MBR_ID = 'quickstart' WHERE MBR_ID = @l_quickstart_prncpl_id;
		UPDATE KRIM_ROLE_MBR_T SET MBR_ID = 'quickstart' WHERE MBR_ID = @l_quickstart_prncpl_id;
		DELETE FROM KRIM_ENTITY_T WHERE ENTITY_ID IN ( @l_quickstart_entity_id );

		-- DEMO DATA
		INSERT INTO KRIM_ENTITY_ADDR_T (ENTITY_ADDR_ID, ENTITY_ID, ENT_TYP_CD, ADDR_TYP_CD, ADDR_LINE_1, ADDR_LINE_2, 
		ADDR_LINE_3, CITY_NM, POSTAL_STATE_CD, POSTAL_CD, DFLT_IND, LAST_UPDT_DT, POSTAL_CNTRY_CD, ACTV_IND, OBJ_ID, VER_NBR)
		VALUES (1, (SELECT ENTITY_ID FROM KRIM_PRNCPL_T WHERE PRNCPL_NM = 'majors'), 'PERSON', 'WRK', 'Test Address', 'Test Apt', NULL, 'East Lansing', 'MI', '48823', 'Y', SYSDATE, 'US', 'Y', SYS_GUID(), 1);

		--??? HOW DID THIS HAPPEN -- these IDs are not there anymore
		UPDATE KRIM_ROLE_PERM_T SET PERM_ID = 298 WHERE PERM_ID = 908;
		UPDATE KRIM_ROLE_PERM_T SET PERM_ID = 299 WHERE PERM_ID = 909;
		    
    	UPDATE KREN_PRODCR_T SET NM = 'KC Notification System' WHERE NM = 'Notification System';
		COMMIT;
    
		-- PRODUCER_ID FOR Notification System became 1000 from 1??? This Producer should come from Rice bootstrap
		/*
		DELETE FROM KREN_CHNL_PRODCR_T WHERE PRODCR_ID = 1000;
		DELETE FROM KREN_PRODCR_T WHERE PRODCR_ID = 1000;
		insert into KREN_PRODCR_T (PRODCR_ID, NM, DESC_TXT, CNTCT_INFO, VER_NBR)
		values (1, 'Notification System', 'This producer represents messages sent from the general message sending forms.', 'kuali-ken-testing@cornell.edu', 1);

		INSERT INTO KREN_CHNL_PRODCR_T (CHNL_ID, PRODCR_ID) VALUES ('1000', '1');
		
		-- Temporary till KC System User gets fixed
		SELECT ENTITY_ID INTO l_kcuser_entity_id FROM KRIM_PRNCPL_T WHERE PRNCPL_NM = 'kc';
		DELETE FROM KRIM_PRNCPL_T WHERE ENTITY_ID = l_kcuser_entity_id;
		DELETE FROM KRIM_ENTITY_ENT_TYP_T  WHERE ENTITY_ID = l_kcuser_entity_id;
		DELETE FROM KRIM_ENTITY_T  WHERE ENTITY_ID = l_kcuser_entity_id;
		
		INSERT INTO KRIM_ENTITY_T (ENTITY_ID, OBJ_ID, VER_NBR, ACTV_IND, LAST_UPDT_DT) VALUES ('1200', SYS_GUID(), 1, 'Y', SYSDATE);
		INSERT INTO KRIM_ENTITY_ENT_TYP_T (ACTV_IND, OBJ_ID, VER_NBR, ENT_TYP_CD, ENTITY_ID, LAST_UPDT_DT) VALUES ('Y', SYS_GUID(), 1, 'SYSTEM', '1200', SYSDATE);
		INSERT INTO KRIM_PRNCPL_T (ACTV_IND,ENTITY_ID,LAST_UPDT_DT,OBJ_ID,PRNCPL_ID,PRNCPL_NM,VER_NBR) VALUES ('Y','1200',SYSDATE, SYS_GUID(), 10000000065,'kc',1)

		-- COLLISION WITH KFS DATA -- everything below 68 is Rice data, so I am guessing we have to renumber all of these.
		-- SELECT * FROM KRIM_TYP_T WHERE NMSPC_CD LIKE 'KC%';-- 68, 69
		ALTER TABLE KRIM_ROLE_MBR_ATTR_DATA_T DISABLE CONSTRAINT KRIM_ROLE_MBR_ATTR_DATA_TR1;
		UPDATE KRIM_ROLE_MBR_ATTR_DATA_T SET KIM_TYP_ID = 101 WHERE KIM_TYP_ID = 68;
		UPDATE KRIM_ROLE_MBR_ATTR_DATA_T SET KIM_TYP_ID = 102 WHERE KIM_TYP_ID = 69;
		ALTER TABLE KRIM_ROLE_T DISABLE CONSTRAINT KRIM_ROLE_TR1;
		UPDATE KRIM_ROLE_T SET KIM_TYP_ID = 101 WHERE KIM_TYP_ID = 68;
		UPDATE KRIM_ROLE_T SET KIM_TYP_ID = 102 WHERE KIM_TYP_ID = 69;
		ALTER TABLE KRIM_TYP_ATTR_T DISABLE CONSTRAINT KRIM_TYP_ATTRIBUTE_TR1;
		UPDATE KRIM_TYP_ATTR_T SET KIM_TYP_ID = 101 WHERE KIM_TYP_ID = 68;
		UPDATE KRIM_TYP_ATTR_T SET KIM_TYP_ID = 102 WHERE KIM_TYP_ID = 69;
		
		UPDATE KRIM_TYP_T SET KIM_TYP_ID = 101 WHERE KIM_TYP_ID = 68;
		UPDATE KRIM_TYP_T SET KIM_TYP_ID = 102 WHERE KIM_TYP_ID = 69;
		
		ALTER TABLE KRIM_TYP_ATTR_T ENABLE CONSTRAINT KRIM_TYP_ATTRIBUTE_TR1;
		ALTER TABLE KRIM_ROLE_T ENABLE CONSTRAINT KRIM_ROLE_TR1;
		ALTER TABLE KRIM_ROLE_MBR_ATTR_DATA_T ENABLE CONSTRAINT KRIM_ROLE_MBR_ATTR_DATA_TR1;
		
		-- 113, 114 --> 201, 202
		-- SELECT * FROM KRIM_TYP_ATTR_T WHERE KIM_TYP_ID IN (SELECT KIM_TYP_ID FROM KRIM_TYP_T WHERE NMSPC_CD LIKE 'KC%');-- 113, 114
		UPDATE KRIM_TYP_ATTR_T SET KIM_TYP_ATTR_ID = 201 WHERE KIM_TYP_ATTR_ID = 113;
		UPDATE KRIM_TYP_ATTR_T SET KIM_TYP_ATTR_ID = 202 WHERE KIM_TYP_ATTR_ID = 114;
		
		-- 98 -> 201
		-- SELECT ROLE_ID, ROLE_NM, NMSPC_CD, DESC_TXT, KIM_TYP_ID, ACTV_IND, OBJ_ID, VER_NBR FROM KRIM_ROLE_T WHERE NMSPC_CD LIKE 'KC%'; --98
		
		ALTER TABLE KRIM_ROLE_MBR_T DISABLE CONSTRAINT KRIM_ROLE_MBR_TR1;
		UPDATE KRIM_ROLE_MBR_T SET ROLE_ID = 201 WHERE ROLE_ID = 98;
		--no constraint in KRIM_ROLE_PERM_T
		UPDATE KRIM_ROLE_PERM_T SET ROLE_ID = 201 WHERE ROLE_ID = 98;
		--no constraint in KRIM_ROLE_RSP_T
		UPDATE KRIM_ROLE_RSP_T SET ROLE_ID = 201 WHERE ROLE_ID = 98;
		
		UPDATE KRIM_ROLE_T SET ROLE_ID = 201 WHERE ROLE_ID = 98;
		ALTER TABLE KRIM_ROLE_MBR_T ENABLE CONSTRAINT KRIM_ROLE_MBR_TR1;

		-- 2 TO 17 -> 501 TO 516
		-- SELECT * FROM KRIM_RSP_T WHERE NMSPC_CD LIKE 'KC%' ORDER BY TO_NUMBER(RSP_ID); -- 2 TO 17

		ALTER TABLE KRIM_ROLE_RSP_T DISABLE CONSTRAINT KRIM_ROLE_RSP_TR1;
		UPDATE KRIM_ROLE_RSP_T SET RSP_ID = 501 WHERE RSP_ID = 2;
		UPDATE KRIM_ROLE_RSP_T SET RSP_ID = 502 WHERE RSP_ID = 3;
		UPDATE KRIM_ROLE_RSP_T SET RSP_ID = 503 WHERE RSP_ID = 4;
		UPDATE KRIM_ROLE_RSP_T SET RSP_ID = 504 WHERE RSP_ID = 5;
		UPDATE KRIM_ROLE_RSP_T SET RSP_ID = 505 WHERE RSP_ID = 6;
		UPDATE KRIM_ROLE_RSP_T SET RSP_ID = 506 WHERE RSP_ID = 7;
		UPDATE KRIM_ROLE_RSP_T SET RSP_ID = 507 WHERE RSP_ID = 8;
		UPDATE KRIM_ROLE_RSP_T SET RSP_ID = 508 WHERE RSP_ID = 9;
		UPDATE KRIM_ROLE_RSP_T SET RSP_ID = 509 WHERE RSP_ID = 10;
		UPDATE KRIM_ROLE_RSP_T SET RSP_ID = 510 WHERE RSP_ID = 11;
		UPDATE KRIM_ROLE_RSP_T SET RSP_ID = 511 WHERE RSP_ID = 12;
		UPDATE KRIM_ROLE_RSP_T SET RSP_ID = 512 WHERE RSP_ID = 13;
		UPDATE KRIM_ROLE_RSP_T SET RSP_ID = 513 WHERE RSP_ID = 14;
		UPDATE KRIM_ROLE_RSP_T SET RSP_ID = 514 WHERE RSP_ID = 15;
		UPDATE KRIM_ROLE_RSP_T SET RSP_ID = 515 WHERE RSP_ID = 16;
		UPDATE KRIM_ROLE_RSP_T SET RSP_ID = 516 WHERE RSP_ID = 17;
		
		ALTER TABLE KRIM_RSP_ATTR_DATA_T DISABLE CONSTRAINT KRIM_RSP_ATTR_DATA_TR3;
		UPDATE KRIM_RSP_ATTR_DATA_T SET RSP_ID = 501 WHERE RSP_ID = 2;
		UPDATE KRIM_RSP_ATTR_DATA_T SET RSP_ID = 502 WHERE RSP_ID = 3;
		UPDATE KRIM_RSP_ATTR_DATA_T SET RSP_ID = 503 WHERE RSP_ID = 4;
		UPDATE KRIM_RSP_ATTR_DATA_T SET RSP_ID = 504 WHERE RSP_ID = 5;
		UPDATE KRIM_RSP_ATTR_DATA_T SET RSP_ID = 505 WHERE RSP_ID = 6;
		UPDATE KRIM_RSP_ATTR_DATA_T SET RSP_ID = 506 WHERE RSP_ID = 7;
		UPDATE KRIM_RSP_ATTR_DATA_T SET RSP_ID = 507 WHERE RSP_ID = 8;
		UPDATE KRIM_RSP_ATTR_DATA_T SET RSP_ID = 508 WHERE RSP_ID = 9;
		UPDATE KRIM_RSP_ATTR_DATA_T SET RSP_ID = 509 WHERE RSP_ID = 10;
		UPDATE KRIM_RSP_ATTR_DATA_T SET RSP_ID = 510 WHERE RSP_ID = 11;
		UPDATE KRIM_RSP_ATTR_DATA_T SET RSP_ID = 511 WHERE RSP_ID = 12;
		UPDATE KRIM_RSP_ATTR_DATA_T SET RSP_ID = 512 WHERE RSP_ID = 13;
		UPDATE KRIM_RSP_ATTR_DATA_T SET RSP_ID = 513 WHERE RSP_ID = 14;
		UPDATE KRIM_RSP_ATTR_DATA_T SET RSP_ID = 514 WHERE RSP_ID = 15;
		UPDATE KRIM_RSP_ATTR_DATA_T SET RSP_ID = 515 WHERE RSP_ID = 16;
		UPDATE KRIM_RSP_ATTR_DATA_T SET RSP_ID = 516 WHERE RSP_ID = 17;
		
		UPDATE KRIM_RSP_T SET RSP_ID = 501 WHERE RSP_ID = 2;
		UPDATE KRIM_RSP_T SET RSP_ID = 502 WHERE RSP_ID = 3;
		UPDATE KRIM_RSP_T SET RSP_ID = 503 WHERE RSP_ID = 4;
		UPDATE KRIM_RSP_T SET RSP_ID = 504 WHERE RSP_ID = 5;
		UPDATE KRIM_RSP_T SET RSP_ID = 505 WHERE RSP_ID = 6;
		UPDATE KRIM_RSP_T SET RSP_ID = 506 WHERE RSP_ID = 7;
		UPDATE KRIM_RSP_T SET RSP_ID = 507 WHERE RSP_ID = 8;
		UPDATE KRIM_RSP_T SET RSP_ID = 508 WHERE RSP_ID = 9;
		UPDATE KRIM_RSP_T SET RSP_ID = 509 WHERE RSP_ID = 10;
		UPDATE KRIM_RSP_T SET RSP_ID = 510 WHERE RSP_ID = 11;
		UPDATE KRIM_RSP_T SET RSP_ID = 511 WHERE RSP_ID = 12;
		UPDATE KRIM_RSP_T SET RSP_ID = 512 WHERE RSP_ID = 13;
		UPDATE KRIM_RSP_T SET RSP_ID = 513 WHERE RSP_ID = 14;
		UPDATE KRIM_RSP_T SET RSP_ID = 514 WHERE RSP_ID = 15;
		UPDATE KRIM_RSP_T SET RSP_ID = 515 WHERE RSP_ID = 16;
		UPDATE KRIM_RSP_T SET RSP_ID = 516 WHERE RSP_ID = 17;
		
		ALTER TABLE KRIM_ROLE_RSP_T ENABLE CONSTRAINT KRIM_ROLE_RSP_TR1;
		ALTER TABLE KRIM_RSP_ATTR_DATA_T ENABLE CONSTRAINT KRIM_RSP_ATTR_DATA_TR3;
		*/
END; 

